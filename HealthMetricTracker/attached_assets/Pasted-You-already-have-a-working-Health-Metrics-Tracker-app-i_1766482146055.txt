You already have a working â€œHealth Metrics Trackerâ€ app in this Repl (FastAPI + SQLite + Streamlit front end). The logic for calories, protein, modes, dynamic targets, and CBT-E entries is fine, but the **UI feels busy and confusing** and itâ€™s not obvious what to do first.

Please MODIFY THE STREAMLIT UI CODE (ğŸ‹ï¸â€â™‚ï¸_app.py and any related UI files). Do not just update documentation. I want a **much clearer user flow** and a guided experience.

========================================
1. OVERALL DESIGN GOAL
========================================

Design the **Today** tab as a simple, top-to-bottom â€œwizardâ€:

> Step 1: Choose date & goal  
> Step 2: Enter todayâ€™s core metrics  
> Step 3: Log food & snacks  
> Step 4: Read todayâ€™s summary

Everything else (weekly/monthly stats, historical charts, advanced metrics) should be **secondary**, hidden by default in expanders or on the **History** tab.

Keep all existing backend logic and routes; just reorganise the layout, labels, and components.

========================================
2. TODAY TAB â€“ CLEAR STEP-BY-STEP FLOW
========================================

In ğŸ‹ï¸â€â™‚ï¸_app.py, refactor the Today tab into clearly labelled sections with headings like â€œStep 1â€, â€œStep 2â€, etc:

### Step 1 â€“ Select date & goal

- At the very top, show:
  - Date selector (single `st.date_input` or similar).
  - Goal mode dropdown (Maintenance / Gentle / Standard / Aggressive loss).
- You can keep advanced goal settings (maintenance calories, rolling window, loss percentages) but move them into an **â€œAdvanced goal settingsâ€** `st.expander` BELOW the basic dropdown, not in a big card on the right.
- Brief helper text under the date / goal explaining the flow, e.g. â€œStart by choosing the date you want to log. Then pick your goal for this period.â€

### Step 2 â€“ Enter todayâ€™s core metrics

Immediately below Step 1, create a single card / container with:

- Weight (kg)
- Steps
- Total calories burned
- Protein target (g) (if editable)
- Any other necessary per-day fields

Layout these in 2 columns so they read cleanly.

Behaviour:

- When any field changes (on blur or with a short debounce), call the daily-metrics upsert API and refresh the Today summary.
- Remove or visually downplay the big â€œSave Metricsâ€ button. If you keep a save button, make it subtle and label it â€œSave if auto-save failsâ€ or similar. The normal experience should feel auto-saving.

### Step 3 â€“ Food journal (today only)

Below core metrics, show a â€œFood Journal for this dayâ€ section:

- At the top: a simple â€œAdd entryâ€ row with:
  - Time
  - Meal slot
  - Food & drink text
  - Calories
  - Protein
  - Optional â€œMoreâ€¦â€ button that reveals place, V/L, star flag and context comments if needed.
- Below that, show **only todayâ€™s entries**, not historical ones, in a clean list or compact table:
  - Make each entry look like a card:
    - First line: time + meal slot + calories + protein as small badges.
    - Second line: food description.
    - Optional third line: context / comments in smaller font.
  - A small icon/button on the right to delete an entry.
- After adding or deleting an entry, automatically refresh the Today summary so eaten calories, balance and protein all update.

### Step 4 â€“ Todayâ€™s summary (high impact, low noise)

Under the journal, create a â€œToday at a Glanceâ€ card that focuses on:

- Mode (word only, e.g. â€œMaintenanceâ€ or â€œStandard Weight Lossâ€).
- One big **Calorie balance** number (green if healthy deficit, amber for small surplus, red for large surplus).
- Progress bars for:
  - Calories eaten vs **dynamic target for the day**.
  - Protein eaten vs protein target.

Make this visually simple:

- One or two lines of **plain-English summary** only, e.g.
  - â€œYou have eaten 1,920 kcal of your 2,600 kcal target (74%) and are in a 350 kcal deficit so far.â€
  - â€œProtein is 140 g out of a 150 g target (93%), which is close to your goal.â€

Avoid long paragraphs and emojis; keep it concise and readable.

### Weekly/monthly stats on Today

- The weekly/monthly stats panel can remain on the Today tab, but place it in an `st.expander("Weekly & monthly trends")` below the main summary so it doesnâ€™t distract from the core daily flow.

========================================
3. HISTORY TAB â€“ SIMPLE, READ-ONLY OVERVIEW
========================================

On the **History** tab:

- Keep things **read-only** and minimal.
- Show:
  - A table with one row per day (date, weight, calories eaten, calories burned, daily_calorie_target, calorie balance, mode, protein total).
  - 2â€“3 charts max:
    - Weight over time
    - 7-day rolling calorie balance
    - Optional protein trend

Do not repeat all the entry forms here. History is for review, not editing.

========================================
4. REDUCE VISUAL CLUTTER & GUIDANCE
========================================

Apply these clean-up rules:

- Use fewer strong colours; reserve red/green for â€œbad/goodâ€ status and keep other elements neutral.
- Reduce repeated labels; if â€œHealth Metrics Trackerâ€ is already at the top, you donâ€™t need extra big headings above every card.
- Group related elements into cards with clear headings rather than separate floating widgets.
- Add very short helper text at the top of the Today tab, something like:

  â€œ1. Pick a date and goal, 2. Enter weight/steps/burn, 3. Add meals and snacks, 4. Read your summary.â€

========================================
5. TOOLTIP HINTS FOR KEY METRICS
========================================

For metrics that are not obvious, add short tooltips (via `help=` or similar):

- On average burn, average deficit, average weight.
- On 7-day rolling balance.
- On each goal mode in the dropdown (â€œMaintenanceâ€, â€œStandard lossâ€, etc.).
- On â€œTotal calories burnedâ€ and â€œProtein targetâ€.

========================================
6. IMPLEMENTATION NOTES
========================================

- Actually edit ğŸ‹ï¸â€â™‚ï¸_app.py and any supporting frontend code to reorganise the layout as above.
- Do NOT remove any existing backend functionality for dynamic targets, protein, or CBT-E logging; just make the UI flow cleaner.
- After changes, run the app and ensure:
  - It starts without errors.
  - The Today tab clearly reads as Step 1 â†’ Step 2 â†’ Step 3 â†’ Step 4.
  - I can pick a date, enter metrics, log food, and immediately see the summary update without hunting around the page.

Please go ahead and implement these UI changes now.
